<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/library/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>AdvancedHMC.jl · AdvancedHMC</title><meta content="AdvancedHMC.jl · AdvancedHMC" name="title"/><meta content="AdvancedHMC.jl · AdvancedHMC" property="og:title"/><meta content="AdvancedHMC.jl · AdvancedHMC" property="twitter:title"/><meta content="Documentation for AdvancedHMC." name="description"/><meta content="Documentation for AdvancedHMC." property="og:description"/><meta content="Documentation for AdvancedHMC." property="twitter:description"/><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/><link href="../../../assets/multidoc-custom.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><div class="nav-dropdown"><button class="nav-item dropdown-label">Modelling languages</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../DynamicPPL/">DynamicPPL</a><a class="nav-link nav-item" href="../../../JuliaBUGS/">JuliaBUGS</a><a class="nav-link nav-item" href="../../../TuringGLM/">TuringGLM</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">MCMC</button><ul class="nav-dropdown-container"><a class="nav-link active nav-item" href="../../">AdvancedHMC</a><a class="nav-link nav-item" href="../../../AbstractMCMC/">AbstractMCMC</a><a class="nav-link nav-item" href="../../../ThermodynamicIntegration/">ThermodynamicIntegration</a><a class="nav-link nav-item" href="../../../AdvancedPS/">AdvancedPS</a><a class="nav-link nav-item" href="../../../EllipticalSliceSampling/">EllipticalSliceSampling</a><a class="nav-link nav-item" href="../../../NestedSamplers/">NestedSamplers</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Diagnostics</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../MCMCChains/">MCMCChains</a><a class="nav-link nav-item" href="../../../MCMCDiagnosticTools/">MCMCDiagnosticTools</a><a class="nav-link nav-item" href="../../../ParetoSmooth/">ParetoSmooth</a></ul></div><a class="nav-link nav-item" href="../../../Bijectors/">Bijectors</a><a class="nav-link nav-item" href="../../../TuringCallbacks/">TuringCallbacks</a><a class="nav-link nav-item" href="../../../TuringBenchmarking/">TuringBenchmarking</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Gaussian Processes</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../AbstractGPs/">AbstractGPs</a><a class="nav-link nav-item" href="../../../KernelFunctions/">KernelFunctions</a><a class="nav-link nav-item" href="../../../ApproximateGPs/">ApproximateGPs</a></ul></div><div class="search nav-item"><input id="search-input" placeholder="Search..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AdvancedHMC</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">AdvancedHMC.jl</a></li><li class="is-active"><a class="tocitem" href="">AdvancedHMC.jl</a><ul class="internal"><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#More-types"><span>More types</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">AdvancedHMC.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">AdvancedHMC.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TuringLang/AdvancedHMC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="AdvancedHMC.jl"><a class="docs-heading-anchor" href="#AdvancedHMC.jl">AdvancedHMC.jl</a><a id="AdvancedHMC.jl-1"></a><a class="docs-heading-anchor-permalink" href="#AdvancedHMC.jl" title="Permalink"></a></h1><p>Documentation for AdvancedHMC.jl</p><ul><li><a href="#AdvancedHMC.jl">AdvancedHMC.jl</a></li><li class="no-marker"><ul><li><a href="#Types">Types</a></li><li><a href="#Functions">Functions</a></li><li><a href="#More-types">More types</a></li></ul></li><li><a href="../#AdvancedHMC.jl">AdvancedHMC.jl</a></li><li class="no-marker"><ul><li><a href="../#A-minimal-example-sampling-from-a-multivariate-Gaussian-using-NUTS">A minimal example - sampling from a multivariate Gaussian using NUTS</a></li><li><a href="../#API-and-supported-HMC-algorithms">API and supported HMC algorithms</a></li><li><a href="../#The-sample-function-signature-in-detail">The <code>sample</code> function signature in detail</a></li><li><a href="../#Citing-AdvancedHMC.jl">Citing AdvancedHMC.jl</a></li><li><a href="../#References">References</a></li></ul></li></ul><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.ClassicNoUTurn" id="AdvancedHMC.ClassicNoUTurn"><code>AdvancedHMC.ClassicNoUTurn</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ClassicNoUTurn{F&lt;:AbstractFloat} &lt;: AdvancedHMC.DynamicTerminationCriterion</code></pre><p>Classic No-U-Turn criterion as described in Eq. (9) in [1].</p><p>Informally, this will terminate the trajectory expansion if continuing the simulation either forwards or backwards in time will decrease the distance between the left-most and right-most positions.</p><p><strong>Fields</strong></p><ul><li><p><code>max_depth::Int64</code></p></li><li><p><code>Δ_max::AbstractFloat</code></p></li></ul><p><strong>References</strong></p><ol><li>Hoffman, M. D., &amp; Gelman, A. (2014). The No-U-Turn Sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research, 15(1), 1593-1623. (<a href="http://arxiv.org/abs/1111.4246">arXiv</a>)</li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L388" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMCSampler" id="AdvancedHMC.HMCSampler"><code>AdvancedHMC.HMCSampler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMCSampler</code></pre><p>An <code>AbstractMCMC.AbstractSampler</code> for kernels in AdvancedHMC.jl.</p><p><strong>Fields</strong></p><ul><li><p><code>κ</code>: <a href="#AdvancedHMC.AbstractMCMCKernel-api"><code>AbstractMCMCKernel</code></a>.</p></li><li><p><code>metric</code>: Choice of initial metric <a href="#AdvancedHMC.AbstractMetric-api"><code>AbstractMetric</code></a>. The metric type will be preserved during adaption.</p></li><li><p><code>adaptor</code>: <a href="#AdvancedHMC.Adaptation.AbstractAdaptor-api"><code>AdvancedHMC.Adaptation.AbstractAdaptor</code></a>.</p></li></ul><p><strong>Notes</strong></p><p>Note that all the fields have the prefix <code>initial_</code> to indicate that these will not necessarily correspond to the <code>kernel</code>, <code>metric</code>, and <code>adaptor</code> after sampling.</p><p>To access the updated fields, use the resulting <a href="#AdvancedHMC.HMCState-api"><code>HMCState</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L37-L53" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMC" id="AdvancedHMC.HMC"><code>AdvancedHMC.HMC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMC(ϵ::Real, n_leapfrog::Int)</code></pre><p>Hamiltonian Monte Carlo sampler with static trajectory.</p><p><strong>Fields</strong></p><ul><li><p><code>n_leapfrog</code>: Number of leapfrog steps.</p></li><li><p><code>integrator</code>: Choice of integrator, specified either using a <code>Symbol</code> or <a href="#AdvancedHMC.AbstractIntegrator-api"><code>AbstractIntegrator</code></a></p></li><li><p><code>metric</code>: Choice of initial metric;  <code>Symbol</code> means it is automatically initialised. The metric type will be preserved during automatic initialisation and adaption.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L102-L110" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.NUTS" id="AdvancedHMC.NUTS"><code>AdvancedHMC.NUTS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NUTS(δ::Real; max_depth::Int=10, Δ_max::Real=1000, integrator = :leapfrog, metric = :diagonal)</code></pre><p>No-U-Turn Sampler (NUTS) sampler.</p><p><strong>Fields</strong></p><ul><li><p><code>δ</code>: Target acceptance rate for dual averaging.</p></li><li><p><code>max_depth</code>: Maximum doubling tree depth.</p></li><li><p><code>Δ_max</code>: Maximum divergence during doubling tree.</p></li><li><p><code>integrator</code>: Choice of integrator, specified either using a <code>Symbol</code> or <a href="#AdvancedHMC.AbstractIntegrator-api"><code>AbstractIntegrator</code></a></p></li><li><p><code>metric</code>: Choice of initial metric;  <code>Symbol</code> means it is automatically initialised. The metric type will be preserved during automatic initialisation and adaption.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L69-L77" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMCDA" id="AdvancedHMC.HMCDA"><code>AdvancedHMC.HMCDA</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMCDA(δ::Real, λ::Real, integrator = :leapfrog, metric = :diagonal)</code></pre><p>Hamiltonian Monte Carlo sampler with Dual Averaging algorithm.</p><p><strong>Fields</strong></p><ul><li><p><code>δ</code>: Target acceptance rate for dual averaging.</p></li><li><p><code>λ</code>: Target leapfrog length.</p></li><li><p><code>integrator</code>: Choice of integrator, specified either using a <code>Symbol</code> or <a href="#AdvancedHMC.AbstractIntegrator-api"><code>AbstractIntegrator</code></a></p></li><li><p><code>metric</code>: Choice of initial metric;  <code>Symbol</code> means it is automatically initialised. The metric type will be preserved during automatic initialisation and adaption.</p></li></ul><p><strong>Notes</strong></p><p>For more information, please view the following paper (<a href="https://arxiv.org/abs/1111.4246">arXiv link</a>):</p><ul><li>Hoffman, Matthew D., and Andrew Gelman. "The No-U-turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo." Journal of Machine Learning Research 15, no. 1 (2014): 1593-1623.</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L130-L146" target="_blank">source</a></section></article><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#StatsBase.sample" id="StatsBase.sample"><code>StatsBase.sample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sample([rng], a, [wv::AbstractWeights])</code></pre><p>Select a single random element of <code>a</code>. Sampling probabilities are proportional to the weights given in <code>wv</code>, if provided.</p><p>Optionally specify a random number generator <code>rng</code> as the first argument (defaults to <code>Random.default_rng()</code>).</p></div><a class="docs-sourcelink" href="https://github.com/JuliaStats/StatsBase.jl/blob/v0.34.2/src/sampling.jl#L462-L470" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample([rng], a, [wv::AbstractWeights], n::Integer; replace=true, ordered=false)</code></pre><p>Select a random, optionally weighted sample of size <code>n</code> from an array <code>a</code> using a polyalgorithm. Sampling probabilities are proportional to the weights given in <code>wv</code>, if provided. <code>replace</code> dictates whether sampling is performed with replacement. <code>ordered</code> dictates whether an ordered sample (also called a sequential sample, i.e. a sample where items appear in the same order as in <code>a</code>) should be taken.</p><p>Optionally specify a random number generator <code>rng</code> as the first argument (defaults to <code>Random.default_rng()</code>).</p></div><a class="docs-sourcelink" href="https://github.com/JuliaStats/StatsBase.jl/blob/v0.34.2/src/sampling.jl#L534-L546" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample([rng], a, [wv::AbstractWeights], dims::Dims; replace=true, ordered=false)</code></pre><p>Select a random, optionally weighted sample from an array <code>a</code> specifying the dimensions <code>dims</code> of the output array. Sampling probabilities are proportional to the weights given in <code>wv</code>, if provided. <code>replace</code> dictates whether sampling is performed with replacement. <code>ordered</code> dictates whether an ordered sample (also called a sequential sample, i.e. a sample where items appear in the same order as in <code>a</code>) should be taken.</p><p>Optionally specify a random number generator <code>rng</code> as the first argument (defaults to <code>Random.default_rng()</code>).</p></div><a class="docs-sourcelink" href="https://github.com/JuliaStats/StatsBase.jl/blob/v0.34.2/src/sampling.jl#L555-L567" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample([rng], wv::AbstractWeights)</code></pre><p>Select a single random integer in <code>1:length(wv)</code> with probabilities proportional to the weights given in <code>wv</code>.</p><p>Optionally specify a random number generator <code>rng</code> as the first argument (defaults to <code>Random.default_rng()</code>).</p></div><a class="docs-sourcelink" href="https://github.com/JuliaStats/StatsBase.jl/blob/v0.34.2/src/sampling.jl#L581-L589" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample(
    rng::Random.AbatractRNG=Random.default_rng(),
    model::AbstractModel,
    sampler::AbstractSampler,
    N_or_isdone;
    kwargs...,
)</code></pre><p>Sample from the <code>model</code> with the Markov chain Monte Carlo <code>sampler</code> and return the samples.</p><p>If <code>N_or_isdone</code> is an <code>Integer</code>, exactly <code>N_or_isdone</code> samples are returned.</p><p>Otherwise, sampling is performed until a convergence criterion <code>N_or_isdone</code> returns <code>true</code>. The convergence criterion has to be a function with the signature</p><pre><code class="language-julia hljs">isdone(rng, model, sampler, samples, state, iteration; kwargs...)</code></pre><p>where <code>state</code> and <code>iteration</code> are the current state and iteration of the sampler, respectively. It should return <code>true</code> when sampling should end, and <code>false</code> otherwise.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AbstractMCMC.jl/blob/v5.0.0/src/sample.jl#L23-L43" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample(
    rng::Random.AbstractRNG=Random.default_rng(),
    model::AbstractModel,
    sampler::AbstractSampler,
    parallel::AbstractMCMCEnsemble,
    N::Integer,
    nchains::Integer;
    kwargs...,
)</code></pre><p>Sample <code>nchains</code> Monte Carlo Markov chains from the <code>model</code> with the <code>sampler</code> in parallel using the <code>parallel</code> algorithm, and combine them into a single chain.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AbstractMCMC.jl/blob/v5.0.0/src/sample.jl#L67-L80" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample(
    rng::Random.AbstractRNG=Random.default_rng(),
    logdensity,
    sampler::AbstractSampler,
    N_or_isdone;
    kwargs...,
)</code></pre><p>Wrap the <code>logdensity</code> function in a <a href="@ref"><code>LogDensityModel</code></a>, and call <code>sample</code> with the resulting model instead of <code>logdensity</code>.</p><p>The <code>logdensity</code> function has to support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AbstractMCMC.jl/blob/v5.0.0/src/logdensityproblems.jl#L30-L42" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample(
    rng::Random.AbstractRNG=Random.default_rng(),
    logdensity,
    sampler::AbstractSampler,
    parallel::AbstractMCMCEnsemble,
    N::Integer,
    nchains::Integer;
    kwargs...,
)</code></pre><p>Wrap the <code>logdensity</code> function in a <a href="@ref"><code>LogDensityModel</code></a>, and call <code>sample</code> with the resulting model instead of <code>logdensity</code>.</p><p>The <code>logdensity</code> function has to support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AbstractMCMC.jl/blob/v5.0.0/src/logdensityproblems.jl#L49-L63" target="_blank">source</a></section><section><div><pre><code class="language-julia hljs">sample(
    rng::AbstractRNG,
    h::Hamiltonian,
    κ::AbstractMCMCKernel,
    θ::AbstractVecOrMat{T},
    n_samples::Int,
    adaptor::AbstractAdaptor=NoAdaptation(),
    n_adapts::Int=min(div(n_samples, 10), 1_000);
    drop_warmup::Bool=false,
    verbose::Bool=true,
    progress::Bool=false
)</code></pre><p>Sample <code>n_samples</code> samples using the proposal <code>κ</code> under Hamiltonian <code>h</code>.</p><ul><li>The randomness is controlled by <code>rng</code>. <ul><li>If <code>rng</code> is not provided, <code>GLOBAL_RNG</code> will be used.</li></ul></li><li>The initial point is given by <code>θ</code>.</li><li>The adaptor is set by <code>adaptor</code>, for which the default is no adaptation.<ul><li>It will perform <code>n_adapts</code> steps of adaptation, for which the default is the minimum of <code>1_000</code> and 10% of <code>n_samples</code></li></ul></li><li><code>drop_warmup</code> controls to drop the samples during adaptation phase or not</li><li><code>verbose</code> controls the verbosity</li><li><code>progress</code> controls whether to show the progress meter or not</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/sampler.jl#L134-L156" target="_blank">source</a></section></article><h2 id="More-types"><a class="docs-heading-anchor" href="#More-types">More types</a><a id="More-types-1"></a><a class="docs-heading-anchor-permalink" href="#More-types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.AbstractIntegrator-api" id="AdvancedHMC.AbstractIntegrator-api"><code>AdvancedHMC.AbstractIntegrator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractIntegrator</code></pre><p>Represents an integrator used to simulate the Hamiltonian system.</p><p><strong>Implementation</strong></p><p>A <code>AbstractIntegrator</code> is expected to have the following implementations:</p><ul><li><code>stat</code>(@ref)</li><li><code>nom_step_size</code>(@ref)</li><li><code>step_size</code>(@ref)</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/integrator.jl#L10" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.AbstractMCMCKernel-api" id="AdvancedHMC.AbstractMCMCKernel-api"><code>AdvancedHMC.AbstractMCMCKernel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractMCMCKernel</code></pre><p>Abstract type for HMC kernels. </p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L28" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.AbstractMetric-api" id="AdvancedHMC.AbstractMetric-api"><code>AdvancedHMC.AbstractMetric</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractMetric</code></pre><p>Abstract type for preconditioning metrics. </p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/metric.jl#L1" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.AbstractTerminationCriterion-api" id="AdvancedHMC.AbstractTerminationCriterion-api"><code>AdvancedHMC.AbstractTerminationCriterion</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractTerminationCriterion</code></pre><p>Abstract type for termination criteria for Hamiltonian trajectories, e.g. no-U-turn and fixed number of leapfrog integration steps. </p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L34" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.AbstractTrajectorySampler-api" id="AdvancedHMC.AbstractTrajectorySampler-api"><code>AdvancedHMC.AbstractTrajectorySampler</code></a> — <span class="docstring-category">Type</span></header><section><div><p>How to sample a phase-point from the simulated trajectory.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L86" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.BinaryTree-api" id="AdvancedHMC.BinaryTree-api"><code>AdvancedHMC.BinaryTree</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A full binary tree trajectory with only necessary leaves and information stored.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L499-L501" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.ClassicNoUTurn-api" id="AdvancedHMC.ClassicNoUTurn-api"><code>AdvancedHMC.ClassicNoUTurn</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ClassicNoUTurn{F&lt;:AbstractFloat} &lt;: AdvancedHMC.DynamicTerminationCriterion</code></pre><p>Classic No-U-Turn criterion as described in Eq. (9) in [1].</p><p>Informally, this will terminate the trajectory expansion if continuing the simulation either forwards or backwards in time will decrease the distance between the left-most and right-most positions.</p><p><strong>Fields</strong></p><ul><li><p><code>max_depth::Int64</code></p></li><li><p><code>Δ_max::AbstractFloat</code></p></li></ul><p><strong>References</strong></p><ol><li>Hoffman, M. D., &amp; Gelman, A. (2014). The No-U-Turn Sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research, 15(1), 1593-1623. (<a href="http://arxiv.org/abs/1111.4246">arXiv</a>)</li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L388" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.DynamicTerminationCriterion-api" id="AdvancedHMC.DynamicTerminationCriterion-api"><code>AdvancedHMC.DynamicTerminationCriterion</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type DynamicTerminationCriterion &lt;: AdvancedHMC.AbstractTerminationCriterion</code></pre><p>Abstract type for dynamic Hamiltonian trajectory termination criteria. </p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L46" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.EndPointTS-api" id="AdvancedHMC.EndPointTS-api"><code>AdvancedHMC.EndPointTS</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Samples the end-point of the trajectory.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L89" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.FixedIntegrationTime-api" id="AdvancedHMC.FixedIntegrationTime-api"><code>AdvancedHMC.FixedIntegrationTime</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FixedIntegrationTime{F&lt;:AbstractFloat} &lt;: AdvancedHMC.StaticTerminationCriterion</code></pre><p>Standard HMC implementation with a fixed integration time.</p><p><strong>Fields</strong></p><ul><li><code>λ::AbstractFloat</code>: Total length of the trajectory, i.e. take <code>floor(λ / integrator_step_size)</code> number of leapfrog steps.</li></ul><p><strong>References</strong></p><ol><li>Neal, R. M. (2011). MCMC using Hamiltonian dynamics. Handbook of Markov chain Monte Carlo, 2(11), 2. (<a href="https://arxiv.org/pdf/1206.1901">arXiv</a>) </li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L67" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.FixedNSteps-api" id="AdvancedHMC.FixedNSteps-api"><code>AdvancedHMC.FixedNSteps</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FixedNSteps &lt;: AdvancedHMC.StaticTerminationCriterion</code></pre><p>Static HMC with a fixed number of leapfrog steps.</p><p><strong>Fields</strong></p><ul><li><code>L::Int64</code>: Number of steps to simulate, i.e. length of trajectory will be <code>L + 1</code>.</li></ul><p><strong>References</strong></p><ol><li>Neal, R. M. (2011). MCMC using Hamiltonian dynamics. Handbook of Markov chain Monte Carlo, 2(11), 2. (<a href="https://arxiv.org/pdf/1206.1901">arXiv</a>)</li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L52" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.FullMomentumRefreshment-api" id="AdvancedHMC.FullMomentumRefreshment-api"><code>AdvancedHMC.FullMomentumRefreshment</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Completly resample new momentum.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/hamiltonian.jl#L163" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.GeneralisedNoUTurn-api" id="AdvancedHMC.GeneralisedNoUTurn-api"><code>AdvancedHMC.GeneralisedNoUTurn</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct GeneralisedNoUTurn{F&lt;:AbstractFloat} &lt;: AdvancedHMC.DynamicTerminationCriterion</code></pre><p>Generalised No-U-Turn criterion as described in Section A.4.2 in [1].</p><p><strong>Fields</strong></p><ul><li><p><code>max_depth::Int64</code></p></li><li><p><code>Δ_max::AbstractFloat</code></p></li></ul><p><strong>References</strong></p><ol><li>Betancourt, M. (2017). A Conceptual Introduction to Hamiltonian Monte Carlo. <a href="https://arxiv.org/abs/1701.02434">arXiv preprint arXiv:1701.02434</a>.</li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L407" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMC-api" id="AdvancedHMC.HMC-api"><code>AdvancedHMC.HMC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMC(ϵ::Real, n_leapfrog::Int)</code></pre><p>Hamiltonian Monte Carlo sampler with static trajectory.</p><p><strong>Fields</strong></p><ul><li><p><code>n_leapfrog</code>: Number of leapfrog steps.</p></li><li><p><code>integrator</code>: Choice of integrator, specified either using a <code>Symbol</code> or <a href="#AdvancedHMC.AbstractIntegrator-api"><code>AbstractIntegrator</code></a></p></li><li><p><code>metric</code>: Choice of initial metric;  <code>Symbol</code> means it is automatically initialised. The metric type will be preserved during automatic initialisation and adaption.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L102-L110" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMCDA-api" id="AdvancedHMC.HMCDA-api"><code>AdvancedHMC.HMCDA</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMCDA(δ::Real, λ::Real, integrator = :leapfrog, metric = :diagonal)</code></pre><p>Hamiltonian Monte Carlo sampler with Dual Averaging algorithm.</p><p><strong>Fields</strong></p><ul><li><p><code>δ</code>: Target acceptance rate for dual averaging.</p></li><li><p><code>λ</code>: Target leapfrog length.</p></li><li><p><code>integrator</code>: Choice of integrator, specified either using a <code>Symbol</code> or <a href="#AdvancedHMC.AbstractIntegrator-api"><code>AbstractIntegrator</code></a></p></li><li><p><code>metric</code>: Choice of initial metric;  <code>Symbol</code> means it is automatically initialised. The metric type will be preserved during automatic initialisation and adaption.</p></li></ul><p><strong>Notes</strong></p><p>For more information, please view the following paper (<a href="https://arxiv.org/abs/1111.4246">arXiv link</a>):</p><ul><li>Hoffman, Matthew D., and Andrew Gelman. "The No-U-turn sampler: adaptively setting path lengths in Hamiltonian Monte Carlo." Journal of Machine Learning Research 15, no. 1 (2014): 1593-1623.</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L130-L146" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMCProgressCallback-api" id="AdvancedHMC.HMCProgressCallback-api"><code>AdvancedHMC.HMCProgressCallback</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMCProgressCallback</code></pre><p>A callback to be used with AbstractMCMC.jl's interface, replicating the logging behavior of the non-AbstractMCMC <a href="#StatsBase.sample"><code>sample</code></a>.</p><p><strong>Fields</strong></p><ul><li><p><code>pm</code>: <code>Progress</code> meter from ProgressMeters.jl.</p></li><li><p><code>progress</code>: Specifies whether or not to use display a progress bar.</p></li><li><p><code>verbose</code>: If <code>progress</code> is not specified and this is <code>true</code> some information will be logged upon completion of adaptation.</p></li><li><p><code>num_divergent_transitions</code>: Number of divergent transitions fo far.</p></li><li><p><code>num_divergent_transitions_during_adaption</code></p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/abstractmcmc.jl#L175-L183" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMCSampler-api" id="AdvancedHMC.HMCSampler-api"><code>AdvancedHMC.HMCSampler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMCSampler</code></pre><p>An <code>AbstractMCMC.AbstractSampler</code> for kernels in AdvancedHMC.jl.</p><p><strong>Fields</strong></p><ul><li><p><code>κ</code>: <a href="#AdvancedHMC.AbstractMCMCKernel-api"><code>AbstractMCMCKernel</code></a>.</p></li><li><p><code>metric</code>: Choice of initial metric <a href="#AdvancedHMC.AbstractMetric-api"><code>AbstractMetric</code></a>. The metric type will be preserved during adaption.</p></li><li><p><code>adaptor</code>: <a href="#AdvancedHMC.Adaptation.AbstractAdaptor-api"><code>AdvancedHMC.Adaptation.AbstractAdaptor</code></a>.</p></li></ul><p><strong>Notes</strong></p><p>Note that all the fields have the prefix <code>initial_</code> to indicate that these will not necessarily correspond to the <code>kernel</code>, <code>metric</code>, and <code>adaptor</code> after sampling.</p><p>To access the updated fields, use the resulting <a href="#AdvancedHMC.HMCState-api"><code>HMCState</code></a>.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L37-L53" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.HMCState-api" id="AdvancedHMC.HMCState-api"><code>AdvancedHMC.HMCState</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMCState</code></pre><p>Represents the state of a <a href="#AdvancedHMC.HMCSampler"><code>HMCSampler</code></a>.</p><p><strong>Fields</strong></p><ul><li><p><code>i</code>: Index of current iteration.</p></li><li><p><code>transition</code>: Current <a href="#AdvancedHMC.Transition-api"><code>Transition</code></a>.</p></li><li><p><code>metric</code>: Current <a href="#AdvancedHMC.AbstractMetric-api"><code>AbstractMetric</code></a>, possibly adapted.</p></li><li><p><code>κ</code>: Current <a href="#AdvancedHMC.AbstractMCMCKernel-api"><code>AbstractMCMCKernel</code></a>.</p></li><li><p><code>adaptor</code>: Current <a href="#AdvancedHMC.Adaptation.AbstractAdaptor-api"><code>AbstractAdaptor</code></a>.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/abstractmcmc.jl#L1-L10" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.JitteredLeapfrog-api" id="AdvancedHMC.JitteredLeapfrog-api"><code>AdvancedHMC.JitteredLeapfrog</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct JitteredLeapfrog{FT&lt;:AbstractFloat, T&lt;:Union{AbstractArray{FT&lt;:AbstractFloat, 1}, FT&lt;:AbstractFloat}} &lt;: AdvancedHMC.AbstractLeapfrog{T&lt;:Union{AbstractArray{FT&lt;:AbstractFloat, 1}, FT&lt;:AbstractFloat}}</code></pre><p>Leapfrog integrator with randomly "jittered" step size <code>ϵ</code> for every trajectory.</p><p><strong>Fields</strong></p><ul><li><p><code>ϵ0::Union{AbstractVector{FT}, FT} where FT&lt;:AbstractFloat</code>: Nominal (non-jittered) step size.</p></li><li><p><code>jitter::AbstractFloat</code>: The proportion of the nominal step size <code>ϵ0</code> that may be added or subtracted.</p></li><li><p><code>ϵ::Union{AbstractVector{FT}, FT} where FT&lt;:AbstractFloat</code>: Current (jittered) step size.</p></li></ul><p><strong>Description</strong></p><p>This is the same as <code>LeapFrog</code>(@ref) but with a "jittered" step size. This means  that at the beginning of each trajectory we sample a step size <code>ϵ</code> by adding or  subtracting from the nominal/base step size <code>ϵ0</code> some random proportion of <code>ϵ0</code>,  with the proportion specified by <code>jitter</code>, i.e. <code>ϵ = ϵ0 - jitter * ϵ0 * rand()</code>. p Jittering might help alleviate issues related to poor interactions with a fixed step size:</p><ul><li>In regions with high "curvature" the current choice of step size might mean over-shoot  leading to almost all steps being rejected. Randomly sampling the step size at the  beginning of the trajectories can therefore increase the probability of escaping such high-curvature regions.</li><li>Exact periodicity of the simulated trajectories might occur, i.e. you might be so unlucky as to simulate the trajectory forwards in time <code>L ϵ</code> and ending up at the same point (which results in non-ergodicity; see Section 3.2 in [1]). If momentum is refreshed before each trajectory, then this should not happen <em>exactly</em> but it can still be an issue in practice. Randomly choosing the step-size <code>ϵ</code> might help alleviate such problems.</li></ul><p><strong>References</strong></p><ol><li>Neal, R. M. (2011). MCMC using Hamiltonian dynamics. Handbook of Markov chain Monte Carlo, 2(11), 2. (<a href="https://arxiv.org/pdf/1206.1901">arXiv</a>)</li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/integrator.jl#L77" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Leapfrog-api" id="AdvancedHMC.Leapfrog-api"><code>AdvancedHMC.Leapfrog</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Leapfrog{T&lt;:(Union{AbstractVector{var"#s29"}, var"#s29"} where var"#s29"&lt;:AbstractFloat)} &lt;: AdvancedHMC.AbstractLeapfrog{T&lt;:(Union{AbstractVector{var"#s29"}, var"#s29"} where var"#s29"&lt;:AbstractFloat)}</code></pre><p>Leapfrog integrator with fixed step size <code>ϵ</code>.</p><p><strong>Fields</strong></p><ul><li><code>ϵ::Union{AbstractVector{var"#s29"}, var"#s29"} where var"#s29"&lt;:AbstractFloat</code>: Step size.</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/integrator.jl#L59" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.MultinomialTS-Tuple{MultinomialTS, AbstractFloat, AdvancedHMC.PhasePoint}-api" id="AdvancedHMC.MultinomialTS-Tuple{MultinomialTS, AbstractFloat, AdvancedHMC.PhasePoint}-api"><code>AdvancedHMC.MultinomialTS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">struct MultinomialTS{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractTrajectorySampler</code></pre><p>Multinomial sampler for a trajectory consisting only a leaf node.</p><ul><li>tree weight is the (unnormalised) energy of the leaf.</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L159" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.MultinomialTS-Tuple{Random.AbstractRNG, AdvancedHMC.PhasePoint}-api" id="AdvancedHMC.MultinomialTS-Tuple{Random.AbstractRNG, AdvancedHMC.PhasePoint}-api"><code>AdvancedHMC.MultinomialTS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">struct MultinomialTS{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractTrajectorySampler</code></pre><p>Multinomial sampler for the starting single leaf tree. (Log) weights for leaf nodes are their (unnormalised) Hamiltonian energies.</p><p>Ref: https://github.com/stan-dev/stan/blob/develop/src/stan/mcmc/hmc/nuts/base_nuts.hpp#L226</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L138" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.MultinomialTS-api" id="AdvancedHMC.MultinomialTS-api"><code>AdvancedHMC.MultinomialTS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct MultinomialTS{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractTrajectorySampler</code></pre><p>Multinomial trajectory sampler carried during the building of the tree. It contains the weight of the tree, defined as the total probabilities of the leaves.</p><p><strong>Fields</strong></p><ul><li><p><code>zcand::AdvancedHMC.PhasePoint</code>: Sampled candidate <code>PhasePoint</code>.</p></li><li><p><code>ℓw::AbstractFloat</code>: Total energy for the given tree, i.e. the sum of energies of all leaves.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L113" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.NUTS-api" id="AdvancedHMC.NUTS-api"><code>AdvancedHMC.NUTS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NUTS(δ::Real; max_depth::Int=10, Δ_max::Real=1000, integrator = :leapfrog, metric = :diagonal)</code></pre><p>No-U-Turn Sampler (NUTS) sampler.</p><p><strong>Fields</strong></p><ul><li><p><code>δ</code>: Target acceptance rate for dual averaging.</p></li><li><p><code>max_depth</code>: Maximum doubling tree depth.</p></li><li><p><code>Δ_max</code>: Maximum divergence during doubling tree.</p></li><li><p><code>integrator</code>: Choice of integrator, specified either using a <code>Symbol</code> or <a href="#AdvancedHMC.AbstractIntegrator-api"><code>AbstractIntegrator</code></a></p></li><li><p><code>metric</code>: Choice of initial metric;  <code>Symbol</code> means it is automatically initialised. The metric type will be preserved during automatic initialisation and adaption.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/constructors.jl#L69-L77" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.PartialMomentumRefreshment-api" id="AdvancedHMC.PartialMomentumRefreshment-api"><code>AdvancedHMC.PartialMomentumRefreshment</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct PartialMomentumRefreshment{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractMomentumRefreshment</code></pre><p>Partial momentum refreshment with refresh rate <code>α</code>.</p><p><strong>Fields</strong></p><ul><li><code>α::AbstractFloat</code></li></ul><p>See equation (5.19) [1]</p><pre><code class="nohighlight hljs">r' = α⋅r + sqrt(1-α²)⋅G</code></pre><p>where r is the momentum and G is a Gaussian random variable.</p><p><strong>References</strong></p><ol><li>Neal, Radford M. "MCMC using Hamiltonian dynamics." Handbook of markov chain monte carlo 2.11 (2011): 2.</li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/hamiltonian.jl#L173" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.SliceTS-Tuple{Random.AbstractRNG, AdvancedHMC.PhasePoint}-api" id="AdvancedHMC.SliceTS-Tuple{Random.AbstractRNG, AdvancedHMC.PhasePoint}-api"><code>AdvancedHMC.SliceTS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">struct SliceTS{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractTrajectorySampler</code></pre><p>Slice sampler for the starting single leaf tree. Slice variable is initialized.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L130" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.SliceTS-Tuple{SliceTS, AbstractFloat, AdvancedHMC.PhasePoint}-api" id="AdvancedHMC.SliceTS-Tuple{SliceTS, AbstractFloat, AdvancedHMC.PhasePoint}-api"><code>AdvancedHMC.SliceTS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">struct SliceTS{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractTrajectorySampler</code></pre><p>Create a slice sampler for a single leaf tree:</p><ul><li>the slice variable is copied from the passed-in sampler <code>s</code> and</li><li>the number of acceptable candicates is computed by comparing the slice variable against the current energy.</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L148" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.SliceTS-api" id="AdvancedHMC.SliceTS-api"><code>AdvancedHMC.SliceTS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct SliceTS{F&lt;:AbstractFloat} &lt;: AdvancedHMC.AbstractTrajectorySampler</code></pre><p>Trajectory slice sampler carried during the building of the tree. It contains the slice variable and the number of acceptable condidates in the tree.</p><p><strong>Fields</strong></p><ul><li><p><code>zcand::AdvancedHMC.PhasePoint</code>: Sampled candidate <code>PhasePoint</code>.</p></li><li><p><code>ℓu::AbstractFloat</code>: Slice variable in log-space.</p></li><li><p><code>n::Int64</code>: Number of acceptable candidates, i.e. those with probability larger than slice variable <code>u</code>.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L92" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.StaticTerminationCriterion-api" id="AdvancedHMC.StaticTerminationCriterion-api"><code>AdvancedHMC.StaticTerminationCriterion</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type StaticTerminationCriterion &lt;: AdvancedHMC.AbstractTerminationCriterion</code></pre><p>Abstract type for a fixed number of leapfrog integration steps.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L40" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.StrictGeneralisedNoUTurn-api" id="AdvancedHMC.StrictGeneralisedNoUTurn-api"><code>AdvancedHMC.StrictGeneralisedNoUTurn</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct StrictGeneralisedNoUTurn{F&lt;:AbstractFloat} &lt;: AdvancedHMC.DynamicTerminationCriterion</code></pre><p>Generalised No-U-Turn criterion as described in Section A.4.2 in [1] with  added U-turn check as described in [2].</p><p><strong>Fields</strong></p><ul><li><p><code>max_depth::Int64</code></p></li><li><p><code>Δ_max::AbstractFloat</code></p></li></ul><p><strong>References</strong></p><ol><li>Betancourt, M. (2017). A Conceptual Introduction to Hamiltonian Monte Carlo. <a href="https://arxiv.org/abs/1701.02434">arXiv preprint arXiv:1701.02434</a>.</li><li><a href="https://github.com/stan-dev/stan/pull/2800">https://github.com/stan-dev/stan/pull/2800</a></li></ol></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L422" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.TemperedLeapfrog-api" id="AdvancedHMC.TemperedLeapfrog-api"><code>AdvancedHMC.TemperedLeapfrog</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct TemperedLeapfrog{FT&lt;:AbstractFloat, T&lt;:Union{AbstractArray{FT&lt;:AbstractFloat, 1}, FT&lt;:AbstractFloat}} &lt;: AdvancedHMC.AbstractLeapfrog{T&lt;:Union{AbstractArray{FT&lt;:AbstractFloat, 1}, FT&lt;:AbstractFloat}}</code></pre><p>Tempered leapfrog integrator with fixed step size <code>ϵ</code> and "temperature" <code>α</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>ϵ::Union{AbstractVector{FT}, FT} where FT&lt;:AbstractFloat</code>: Step size.</p></li><li><p><code>α::AbstractFloat</code>: Temperature parameter.</p></li></ul><p><strong>Description</strong></p><p>Tempering can potentially allow greater exploration of the posterior, e.g.  in a multi-modal posterior jumps between the modes can be more likely to occur.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/integrator.jl#L147" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Termination-Union{Tuple{F}, Tuple{MultinomialTS, Trajectory, F, F}} where F&lt;:AbstractFloat-api" id="AdvancedHMC.Termination-Union{Tuple{F}, Tuple{MultinomialTS, Trajectory, F, F}} where F&lt;:AbstractFloat-api"><code>AdvancedHMC.Termination</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Termination(s, nt, H0, H′)
</code></pre><p>Check termination of a Hamiltonian trajectory.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L485" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Termination-Union{Tuple{F}, Tuple{SliceTS, Trajectory, F, F}} where F&lt;:AbstractFloat-api" id="AdvancedHMC.Termination-Union{Tuple{F}, Tuple{SliceTS, Trajectory, F, F}} where F&lt;:AbstractFloat-api"><code>AdvancedHMC.Termination</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Termination(s, nt, H0, H′)
</code></pre><p>Check termination of a Hamiltonian trajectory.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L476" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Termination-api" id="AdvancedHMC.Termination-api"><code>AdvancedHMC.Termination</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Termination</code></pre><p>Termination reasons</p><ul><li><code>dynamic</code>: due to stoping criteria</li><li><code>numerical</code>: due to large energy deviation from starting (possibly numerical errors)</li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L458-L464" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Trajectory-api" id="AdvancedHMC.Trajectory-api"><code>AdvancedHMC.Trajectory</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Trajectory{TS&lt;:AdvancedHMC.AbstractTrajectorySampler, I&lt;:AdvancedHMC.AbstractIntegrator, TC&lt;:AdvancedHMC.AbstractTerminationCriterion}</code></pre><p>Numerically simulated Hamiltonian trajectories.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L199" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Transition-api" id="AdvancedHMC.Transition-api"><code>AdvancedHMC.Transition</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct Transition{P&lt;:AdvancedHMC.PhasePoint, NT&lt;:NamedTuple}</code></pre><p>A transition that contains the phase point and other statistics of the transition.</p><p><strong>Fields</strong></p><ul><li><p><code>z::AdvancedHMC.PhasePoint</code>: Phase-point for the transition.</p></li><li><p><code>stat::NamedTuple</code>: Statistics related to the transition, e.g. energy.</p></li></ul></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/trajectory.jl#L10" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Adaptation.AbstractAdaptor-api" id="AdvancedHMC.Adaptation.AbstractAdaptor-api"><code>AdvancedHMC.Adaptation.AbstractAdaptor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractAdaptor</code></pre><p>Abstract type for HMC adaptors. </p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/adaptation/Adaptation.jl#L11" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#AdvancedHMC.Adaptation.NesterovDualAveraging-api" id="AdvancedHMC.Adaptation.NesterovDualAveraging-api"><code>AdvancedHMC.Adaptation.NesterovDualAveraging</code></a> — <span class="docstring-category">Type</span></header><section><div><p>An implementation of the Nesterov dual averaging algorithm to tune step size.</p><p>References</p><p>Hoffman, M. D., &amp; Gelman, A. (2014). The No-U-Turn Sampler: adaptively setting path lengths in Hamiltonian Monte Carlo. Journal of Machine Learning Research, 15(1), 1593-1623. Nesterov, Y. (2009). Primal-dual subgradient methods for convex problems. Mathematical programming, 120(1), 221-259.</p></div><a class="docs-sourcelink" href="https://github.com/TuringLang/AdvancedHMC.jl/blob/37f0995ea466ec5a9c9b09ecacc04c317ba77886/src/adaptation/stepsize.jl#L66-L73" target="_blank">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« AdvancedHMC.jl</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.0 on <span class="colophon-date" title="Wednesday 29 November 2023 14:17">Wednesday 29 November 2023</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>